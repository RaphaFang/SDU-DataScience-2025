x <- c(72,75,79,83,91)

# ----------------------------------------------------------------
mean_x <- mean(x) # 會得到平均數，80
print(mean_x) 

# ----------------------------------------------------------------
sd_score <- sd(x) # sample standard deviation
print(sd_score)
# 7.416198

# ----------------------------------------------------------------
# 手算 standard deviation
z_scores <- (x - mean(x)) / sd(x)
print(z_scores)
# -1.0787198 -0.6741999 -0.1348400  0.4045199  1.4832397

# ----------------------------------------------------------------
# sacle 就可以直接算standard deviation
z_scores <- scale(x)
print(z_scores)
#            [,1]
# [1,] -1.0787198
# [2,] -0.6741999
# [3,] -0.1348400
# [4,]  0.4045199
# [5,]  1.4832397
# attr(,"scaled:center")
# [1] 80
# attr(,"scaled:scale")
# [1] 7.416198

z_scores <- as.vector(scale(x))
print(z_scores)
# [1] -1.0787198 -0.6741999 -0.1348400  0.4045199  1.4832397

# ----------------------------------------------------------------
t_score <- 50 + 10 * z_scores
print(t_score)
# 39.2128 43.2580 48.6516 54.0452 64.8324

# ----------------------------------------------------------------
install.packages("ggplot2")  # 第一次執行才需要
library(ggplot2)
df <- data.frame(original = x, z = z_scores, t = t_scores)
print(df)
#   original          z        t
# 1       55 -1.1766968 38.23303
# 2       60 -0.7844645 42.15535
# 3       70  0.0000000 50.00000
# 4       80  0.7844645 57.84465
# 5       85  1.1766968 61.76697


# ----------------------------------------------------------------
write.csv(df, "statistic/t_score/scores.csv", row.names = FALSE)
# "original","z","t"
# 55,-1.1766968108291,38.233031891709
# 60,-0.784464540552736,42.1553545944726
# 70,0,50
# 80,0.784464540552736,57.8446454055274
# 85,1.1766968108291,61.766968108291
